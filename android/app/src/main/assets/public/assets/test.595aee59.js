import{_ as A,g as G,h as W,G as q,m as _,p as J,q as K,E as M,R as O,D as p,T as Q,U as X,Z as Y,o as l,c as i,j as r,F as x,x as Z,a as f,e as H,y as B,z as F,B as b,I as ee,C as k,L as te,J as ae,K as oe,V as se,W as ne,X as ce,Y as le}from"./index.a29c27fe.js";const I=v=>(ce("data-v-45e4116c"),v=v(),le(),v),ie=I(()=>r("div",{id:"top"},null,-1)),re={ref:"el",class:""},ue={key:0,class:"grid place-content-center"},de={class:""},_e={key:0},pe={key:1},ve=I(()=>r("p",null,"\u8BF7\u767B\u5F55",-1)),me=[ve],T=G({__name:"test",setup(v){const m=W(null),s=b(),u=q(),g=_(u,"posts"),h=_(u,"getPosts"),D=_(u,"deletePost");_(u,"UpdatePost");const S=_(u,"clearPosts");J();const y=ee();let $=K();const{addFav:L,deleteFav:E}=M();if(O(g,()=>{}),new Date(s.value.expiryDate).getTime()-new Date().getTime()<0){const{open:e}=p();e("\u767B\u9646\u8BA4\u8BC1\u5DF2\u5931\u6548,\u8BF7\u91CD\u65B0\u767B\u9646"),y.push({name:"Login"})}const P=async()=>{S.value(),await h.value()};s.value.token||y.push({name:"Login"}),g.value.length||P();const N=async e=>{const{open:t,close:o}=k();t(),s.value.isPending=!0;try{await D.value(e._id)}catch(c){const{open:d}=p();d(c)}s.value.isPending=!1,o()},U=async e=>{const{open:t,close:o}=k();t(),s.value.isPending=!0;try{e.isFav?await E(e):await L(e)}catch(c){const{open:d}=p();d(c)}s.value.isPending=!1,o()},V=e=>{const t=b();t.value.postId=e._id,y.push({name:"Comments",params:{id:e._id}})};Q(()=>{if(m.value)X(m.value);else throw new Error(`target is ${m.value||null}`)});const w=te(()=>{$.value=!0},1e3);let n=1;Y(()=>999);const j=async()=>{const{open:e,close:t}=k();e();try{n++,await h.value(n)}catch(o){n--,await h.value(n);const{open:c}=p();c(o)}t()},z=async()=>{const{open:e,close:t}=k();if(e(),n<=1){const{open:o}=p();o("\u5DF2\u7ECF\u662F\u7B2C\u4E00\u9875!")}else n--,await h.value(n);t()};return(e,t)=>{const o=ae,c=oe,d=se,R=ne;return l(),i(x,null,[ie,r("div",re,[s.value.token?(l(),i("div",ue,[r("ul",de,[(l(!0),i(x,null,Z(g.value,a=>(l(),i("li",{key:a._id},[f(o,{creatorId:a.creator,title:a.title,author:a.author,description:a.content,"btn-name":"\u5220\u9664","img-url":a.imageUrl||"https://images-na.ssl-images-amazon.com/images/I/81WcnNQ-TBL.jpg","is-fav":a.isFav,onClickBtn:C=>N(a),onClickStar:C=>U(a),onClickImage:C=>V(a),class:"post-card hover:scale-105 duration-200 drop-shadow-2xl shadow-2xl bg-blend-color-burn"},null,8,["creatorId","title","author","description","img-url","is-fav","onClickBtn","onClickStar","onClickImage"])]))),128)),g.value.length!==0?(l(),i("div",_e,[f(c,{onPagePre:z,onPageNext:j})])):H("",!0)]),r("div",{ref_key:"target",ref:m,class:"flex justify-center bottom-6 fixed"},[f(d,{onCreated:P})],512)])):(l(),i("div",pe,me))],512),r("div",{class:"fixed bottom-5 right-5 hover:text-blue-700 cursor-pointer click",onClick:t[0]||(t[0]=(...a)=>B(w)&&B(w)(...a))},[f(R,{style:{"font-size":"2em"}})])],64)}}});typeof F=="function"&&F(T);var he=A(T,[["__scopeId","data-v-45e4116c"]]);export{he as default};
