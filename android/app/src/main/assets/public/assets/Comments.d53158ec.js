import{g as w,h as M,o,c as u,i as O,v as P,j as e,k as X,n as Z,b as D,e as N,F as g,_ as V,l as ee,t as B,a as x,u as A,m as p,p as te,q as ne,s as F,x as T,y as I,w as oe,z,A as se,B as ae,C as b,D as C}from"./index.a29c27fe.js";const le=["onSubmit"],re=e("fieldset",{class:"py-4"},[e("input",{type:"submit",value:"\u8BC4\u8BBA",class:"px-4 py-1 bg-sky-600 bg-opacity-[90%] text-white cursor-pointer rounded-2xl"}),e("input",{type:"reset",value:"\u53D6\u6D88",class:"px-4 py-1 bg-white bg-opacity-[90%] border ml-3 cursor-pointer rounded-2xl"})],-1),j=w({__name:"CommentBox",emits:["submit"],setup(a,{emit:n}){let t=M("");const i=()=>{n("submit",t.value),t.value=""};return(r,s)=>(o(),u("form",{class:"grid",onSubmit:X(i,["prevent"])},[O(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=$=>t.value=$),name:"comment",id:"",placeholder:"\u8BF7\u8F93\u5165\u4F60\u7684\u8BC4\u8BBA",class:"bg-[#d6d6cb] p-2 rounded bg-opacity-[30%] h-[10rem] border-sky-300 border-[2px] focus-visible:outline-none focus-visible:border-sky-500"},null,512),[[P,t.value]]),re],40,le))}}),ce=w({__name:"ReplyBox",emits:["submit"],setup(a,{emit:n}){const t=M(!1);return(i,r)=>(o(),u(g,null,[e("button",{class:Z(["pt-4 text-blue-600",[t.value?"pb-2":"pb-10"]]),onClick:r[0]||(r[0]=s=>t.value=!t.value)}," \u56DE\u590D ",2),t.value?(o(),D(j,{key:0,class:"mb-4",onSubmit:r[1]||(r[1]=s=>{n("submit",s),t.value=!1})})):N("",!0)],64))}}),ue={},ie={class:"pl-8 border-l-2 border-gray-200"};function me(a,n){return o(),u("div",ie,[ee(a.$slots,"default")])}var de=V(ue,[["render",me]]);const _e={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},pe=e("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor"},null,-1),ve=e("circle",{cx:"12",cy:"5",r:"2",fill:"currentColor"},null,-1),he=e("circle",{cx:"12",cy:"19",r:"2",fill:"currentColor"},null,-1),fe=[pe,ve,he];function ye(a,n){return o(),u("svg",_e,fe)}var xe={name:"eva-more-vertical-fill",render:ye};const be={class:"flex"},Ce=["src"],ge={class:"text-gray-600 text-sm"},we={class:"ml-auto"},$e={class:"p-dropdown p-dropdown-left flex"},Be={tabindex:"0",class:"m-1 cursor-pointer"},De={class:"text-gray-600 py-4"},Re=w({__name:"CommentItem",props:{user:{default:"\u533F\u540D\u7528\u6237"},avatar:{default:"https://images-na.ssl-images-amazon.com/images/I/81WcnNQ-TBL.jpg"},time:{default:"\u672A\u77E5\u65F6\u95F4"},content:{default:""}},emits:["deleteComment"],setup(a,{emit:n}){const t=()=>{n("deleteComment")};return(i,r)=>{const s=xe;return o(),u(g,null,[e("div",be,[e("img",{src:a.avatar,alt:"",class:"w-12 h-12 mr-4 rounded-full"},null,8,Ce),e("div",null,[e("p",null,B(a.user),1),e("p",ge,B(a.time),1)]),e("span",we,[e("div",$e,[e("label",Be,[x(s)]),e("ul",{tabindex:"0",class:"p-dropdown-content p-menu shadow relative truncate top-20"},[e("li",null,[e("a",{class:"py-2 hover:bg-red-400 bg-slate-200",onClick:t},"\u5220\u9664")])])])])]),e("p",De,B(a.content),1)],64)}}}),ke={},Se={class:"border-b border-gray-300 my-2 mb-4"};function Ae(a,n){return o(),u("div",Se)}var Fe=V(ke,[["render",Ae]]),L="/assets/default_avatar.f555a0e3.jpg";const Te={class:"p-4 min-h-screen w-[80vw] max-w-3xl"},Ie={class:"max-w-screen-xl mx-auto p-8 rounded-xl shadow-2xl bg-opacity-25"},ze=e("h2",{class:"text-3xl my-6"},"\u8BC4\u8BBA",-1),Le=w({__name:"Comments",async setup(a){let n,t,i;const r=se(),s=A();p(s,"replies"),p(s,"getReplies");const $=p(s,"addReply"),E=p(s,"deleteReply"),f=te(),R=p(f,"comments"),q=p(f,"addComment"),H=p(f,"deleteComment"),k=p(f,"getComments"),Q=p(f,"clearComment"),{clearReplies:U}=A();let S=ne();Q.value(),U(),r.params.id&&typeof r.params.id=="string"&&!R.value.length?(i=r.params.id,[n,t]=F(()=>k.value(i)),await n,t(),S.value=!0):(i=ae().value.postId,[n,t]=F(()=>k.value(i)),await n,t(),S.value=!0);const W=async l=>{const{open:h,close:m}=b();h();try{await q.value(l,i)}catch(d){const{open:c}=C();c(d)}l="",m()},Y=async(l,h)=>{const{open:m,close:d}=b();m();try{await H.value(l)}catch(c){const{open:y}=C();y(c)}d()},G=async(l,h)=>{const{open:m,close:d}=b();m();try{await $.value(l,h)}catch(c){const{open:y}=C();y(c)}l="",d()},J=async l=>{const{open:h,close:m}=b();h();try{await E.value(l)}catch(d){const{open:c}=C();c(d)}m()};return(l,h)=>{const m=j,d=Fe,c=Re,y=de,K=ce;return o(),u("main",Te,[e("div",Ie,[ze,x(m,{onSubmit:W}),x(d),(o(!0),u(g,null,T(R.value,_=>(o(),u("div",{key:_._id},[x(c,{user:_.creator,avatar:I(L),time:_.time,content:_.content,onDeleteComment:v=>Y(_._id,_.content)},null,8,["user","avatar","time","content","onDeleteComment"]),_.replies?(o(),D(y,{key:0},{default:oe(()=>[(o(!0),u(g,null,T(_.replies,v=>(o(),D(c,{key:v._id,user:v.creator,avatar:I(L),time:v.time,content:v.content,onDeleteComment:Me=>J(v)},null,8,["user","avatar","time","content","onDeleteComment"]))),128))]),_:2},1024)):N("",!0),x(K,{onSubmit:v=>G(v,_._id)},null,8,["onSubmit"])]))),128))])])}}});typeof z=="function"&&z(Le);export{Le as default};
