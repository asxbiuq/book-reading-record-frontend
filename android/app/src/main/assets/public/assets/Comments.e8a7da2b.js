import{g as w,h as N,o as n,c as i,i as O,v as P,j as e,k as X,n as Z,b as D,e as V,F as g,_ as j,l as ee,t as B,a as x,u as A,m as p,p as te,q as oe,s as F,x as T,y as I,w as ne,z,A as se,B as ae,C as b,D as C}from"./index.d6deafee.js";const le=["onSubmit"],re=e("fieldset",{class:"py-4"},[e("input",{type:"submit",value:"\u8BC4\u8BBA",class:"px-4 py-1 bg-sky-600 bg-opacity-[90%] text-white cursor-pointer rounded-2xl"}),e("input",{type:"reset",value:"\u53D6\u6D88",class:"px-4 py-1 bg-white bg-opacity-[90%] border ml-3 cursor-pointer rounded-2xl"})],-1),E=w({__name:"CommentBox",emits:["submit"],setup(l,{emit:o}){let t=N("");const m=()=>{o("submit",t.value),t.value=""};return(u,s)=>(n(),i("form",{class:"grid",onSubmit:X(m,["prevent"])},[O(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=$=>t.value=$),name:"comment",id:"",placeholder:"\u8BF7\u8F93\u5165\u4F60\u7684\u8BC4\u8BBA",class:"bg-[#d6d6cb] p-2 rounded bg-opacity-[30%] h-[10rem] border-sky-300 border-[2px] focus-visible:outline-none focus-visible:border-sky-500"},null,512),[[P,t.value]]),re],40,le))}}),ce=w({__name:"ReplyBox",emits:["submit"],setup(l,{emit:o}){const t=N(!1);return(m,u)=>(n(),i(g,null,[e("button",{class:Z(["pt-4 text-blue-600",[t.value?"pb-2":"pb-10"]]),onClick:u[0]||(u[0]=s=>t.value=!t.value)}," \u56DE\u590D ",2),t.value?(n(),D(E,{key:0,class:"mb-4",onSubmit:u[1]||(u[1]=s=>{o("submit",s),t.value=!1})})):V("",!0)],64))}}),ue={},ie={class:"pl-8 border-l-2 border-gray-200"};function me(l,o){return n(),i("div",ie,[ee(l.$slots,"default")])}var de=j(ue,[["render",me]]);const _e={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},pe=e("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor"},null,-1),ve=e("circle",{cx:"12",cy:"5",r:"2",fill:"currentColor"},null,-1),he=e("circle",{cx:"12",cy:"19",r:"2",fill:"currentColor"},null,-1),fe=[pe,ve,he];function ye(l,o){return n(),i("svg",_e,fe)}var xe={name:"eva-more-vertical-fill",render:ye};const be={class:"flex"},Ce=["src"],ge={class:"text-gray-600 text-sm"},we={class:"ml-auto"},$e={class:"p-dropdown p-dropdown-left flex"},Be={tabindex:"0",class:"m-1 cursor-pointer"},De={class:"text-gray-600 py-4"},Re=w({__name:"CommentItem",props:{user:{default:"\u533F\u540D\u7528\u6237"},avatar:{default:"https://images-na.ssl-images-amazon.com/images/I/81WcnNQ-TBL.jpg"},time:{default:"\u672A\u77E5\u65F6\u95F4"},content:{default:""}},emits:["deleteComment"],setup(l,{emit:o}){const t=()=>{o("deleteComment")};return(m,u)=>{const s=xe;return n(),i(g,null,[e("div",be,[e("img",{src:l.avatar,alt:"",class:"w-12 h-12 mr-4 rounded-full"},null,8,Ce),e("div",null,[e("p",null,B(l.user),1),e("p",ge,B(l.time),1)]),e("span",we,[e("div",$e,[e("label",Be,[x(s)]),e("ul",{tabindex:"0",class:"p-dropdown-content p-menu shadow relative truncate top-20"},[e("li",null,[e("a",{class:"py-2 hover:bg-red-400 bg-slate-200",onClick:t},"\u5220\u9664")])])])])]),e("p",De,B(l.content),1)],64)}}}),ke={},Se={class:"border-b border-gray-300 my-2 mb-4"};function Ae(l,o){return n(),i("div",Se)}var Fe=j(ke,[["render",Ae]]),M="/assets/default_avatar.f555a0e3.jpg";const Te={class:"p-4 min-h-screen w-[80vw] max-w-3xl"},Ie={class:"max-w-screen-xl mx-auto p-8 rounded-xl shadow-2xl bg-opacity-25"},ze=e("h2",{class:"text-3xl my-6"},"\u8BC4\u8BBA",-1),Me=w({__name:"Comments",async setup(l){let o,t,m;const u=se(),s=A();p(s,"replies"),p(s,"getReplies");const $=p(s,"addReply"),L=p(s,"deleteReply"),f=te(),R=p(f,"comments"),q=p(f,"addComment"),H=p(f,"deleteComment"),k=p(f,"getComments"),Q=p(f,"clearComment"),{clearReplies:U}=A();let S=oe();Q.value(),U(),u.params.id&&typeof u.params.id=="string"&&!R.value.length?(m=u.params.id,[o,t]=F(()=>k.value(m)),await o,t(),S.value=!0):(m=ae().value.postId,[o,t]=F(()=>k.value(m)),await o,t(),S.value=!0);const W=async r=>{const{open:h,close:d}=b();h();try{await q.value(r,m)}catch(c){console.log(c);const{open:a}=C();a(c)}r="",d()},Y=async(r,h)=>{const{open:d,close:c}=b();d();try{await H.value(r)}catch(a){console.log(a);const{open:y}=C();y(a)}c()},G=async(r,h)=>{const{open:d,close:c}=b();d();try{await $.value(r,h)}catch(a){console.log(a);const{open:y}=C();y(a)}r="",c()},J=async r=>{const{open:h,close:d}=b();h();try{await L.value(r)}catch(c){console.log(c);const{open:a}=C();a(c)}d()};return(r,h)=>{const d=E,c=Fe,a=Re,y=de,K=ce;return n(),i("main",Te,[e("div",Ie,[ze,x(d,{onSubmit:W}),x(c),(n(!0),i(g,null,T(R.value,_=>(n(),i("div",{key:_._id},[x(a,{user:_.creator,avatar:I(M),time:_.time,content:_.content,onDeleteComment:v=>Y(_._id,_.content)},null,8,["user","avatar","time","content","onDeleteComment"]),_.replies?(n(),D(y,{key:0},{default:ne(()=>[(n(!0),i(g,null,T(_.replies,v=>(n(),D(a,{key:v._id,user:v.creator,avatar:I(M),time:v.time,content:v.content,onDeleteComment:Ne=>J(v)},null,8,["user","avatar","time","content","onDeleteComment"]))),128))]),_:2},1024)):V("",!0),x(K,{onSubmit:v=>G(v,_._id)},null,8,["onSubmit"])]))),128))])])}}});typeof z=="function"&&z(Me);export{Me as default};
